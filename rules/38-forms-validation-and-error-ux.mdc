---
description: フォームのバリデーションタイミング、エラー表示位置、入力支援UXに関するベストプラクティス集です。
globs: ["src/components/ui/form/**/*.tsx", "**/*Form.tsx"]
---

# 38. フォームバリデーションとUX (Forms Validation & UX)

- Description: ユーザーが最もストレスを感じやすい「入力フォーム」を快適にするためのルールです。バリデーションのタイミングやエラーメッセージの親切さにこだわります。

# 1. バリデーションのタイミング

- **Submit時 (必須)**: 全項目の一括チェック。
- **onBlur (推奨)**: 入力欄からフォーカスが外れたタイミングで単体チェック。
    - ユーザーが「入力完了したつもり」の瞬間にフィードバックを返す。
- **onChange (慎重に)**:
    - パスワード強度チェックや、入力可能文字数のカウントダウンには有効。
    - エラーメッセージ（「メールアドレス形式ではありません」など）を出すのはNG（入力中は常にエラーになるため不快）。

# 2. エラーメッセージの表示位置

- **インライン表示**: エラーのある入力項目の **直下** に赤字で表示する。
- **サマリー表示**: 送信ボタンを押して複数のエラーが出た場合、フォームの上部に「3件のエラーがあります」とまとめて表示し、各項目へのリンクを貼る（アクセシビリティ対応）。

# 3. 入力支援UX

- **オートフォーカス**: 画面を開いた瞬間に最初の入力欄にカーソルを合わせる。
- **適切なキーボード**: モバイル向けに `type="email"`, `type="tel"`, `inputMode="numeric"` を適切に設定する。
- **パスワード表示切替**: 目のアイコンでパスワードの伏せ字を解除できるようにする。
- **送信ボタンの状態**:
    - **Loading**: 二重送信防止のため、送信中はボタンを無効化（Disabled）し、スピナーを表示する。
    - **初期Disabled**: 全項目埋まるまでボタンを押せなくするパターンは、なぜ押せないか分からないため推奨しない（押させてからバリデーションエラーを出す方が親切）。

# 4. AIへの指示

- 「このログインフォーム、React Hook FormとZodを使って実装して。バリデーションはonBlurで実行し、エラーメッセージは入力欄の下に出すこと。」
- 「パスワード入力欄に『目のアイコン』をつけて、クリックで表示/非表示を切り替えられるようにして。」
