---
alwaysApply: false
---
Description: ファイルやフォルダの移動・名前変更といったリファクタリング作業を行う際に、プロジェクト全体のコードの整合性を保つためのルールです。「このファイルを移動して」や「このコンポーネントの名前を変えたい」といった指示があった場合に適用してください。

# 1. 基本原則: リファクタリングは「操作」と「修正」のセット
- **考え方**: ファイルの移動や名前の変更は、単なるファイルシステム上の操作ではありません。それは、そのファイルを参照している全てのコードに影響を与える、重大な変更です。したがって、AIは「ファイル操作」と「参照箇所の修正」を、常に一つのアトミックな（不可分な）トランザクションとして扱わなければなりません。

# 2. ファイル・フォルダの移動 (`mv`)
- **ルール**: `mv`コマンドでファイルやフォルダを移動させた後、AIは即座に、移動前の古いパスをプロジェクト全体で検索し、関連する全ての`import`文や`require`文、設定ファイル内のパスなどを、新しいパスに更新する責任を負います。ファイルの移動と参照箇所の更新は、常にセットで実行する必要があります。
- **AIへの指示**: 「`src/utils/formatter.ts`を`src/common/utils/formatter.ts`に移動したい。ファイルの移動を実行した後、この変更によって壊れてしまう全ての`import`文を修正してください。」

# 3. ファイル・コンポーネントの名前変更
- **ルール**: ファイル名やコンポーネント名を変更した場合も、移動と同様です。古い名前を参照している全てのコードを特定し、新しい名前に正確に更新する必要があります。
- **AIへの指示**: 「`LegacyButton.tsx`というコンポーネントの名前を、`StyledButton.tsx`に変更したい。ファイル名を変更し、プロジェクト内の全ての`import LegacyButton from ...`という記述を、新しいコンポーネント名を指すように修正してください。」

# 4. 複雑なリファクタリングはIDEの機能を推奨する
- **考え方**: 単純なテキスト置換では危険な場合があります（例えば、`util`のような一般的な名前を変更する場合など）。IDEには、コードの文脈を理解して安全にリファクタリングを行うための、より強力な機能（シンボル名の変更、など）が備わっています。リスクが高いと判断した場合、AIは自ら実行するのではなく、ユーザーに最適なIDEの機能を使うよう、賢く提案すべきです。
- **AIへの指示**: 「ユーザーが`api.js`のような、非常に多くの場所から参照されているファイルの変更を指示した場合、『このリファクタリングは影響範囲が広いため、手動での置換は危険が伴います。IDEの「シンボルの名前を変更」機能を使うことを強くお勧めしますが、いかがいたしますか？』と確認してください。」

# 5. AIへの最終命令
- 「リファクタリングに関する全ての指示は、単なるファイル操作命令としてではなく、『プロジェクト全体の整合性を維持せよ』という高レベルな命令として解釈してください。操作の実行と、それに伴う影響範囲の修正は、常にセットで実行する義務があります。」